--- a/init	2009-04-02 20:37:59.000000000 +0300
+++ b/init	2009-04-20 15:26:58.000000000 +0300
@@ -4,2 +4,3 @@
 . /etc/initrd.scripts
+. /etc/syspnp
 
@@ -28,2 +29,9 @@
 
+if [[ -f /lib.loopfs ]]; then
+	modprobe loop >/dev/null 2>&1
+	modprobe cramfs >/dev/null 2>&1
+	modprobe squashfs >/dev/null 2>&1
+	mount /lib.loopfs /lib -o loop
+fi
+
 if [ "$0" = '/init' ]
@@ -240,2 +248,3 @@
 	good_msg 'Loading modules'
+	syspnp
 	# Load appropriate kernel modules
@@ -696,2 +705,4 @@
 echo -ne "${BOLD}.${NORMAL}"
+umount /lib
+mod_unload
 umount /sys || echo '*: Failed to unmount the ramdisk /sys!'
